CREATE TABLE "miapp_cliente" (
    "id_cliente" varchar(5) NOT NULL PRIMARY KEY,
    "cli_nombre" varchar(40) NOT NULL,
    "cli_contacto" varchar(30),
    "cli_titulo_contacto" varchar(30),
    "cli_direccion" varchar(60),
    "cli_ciudad" varchar(15),
    "cli_region" varchar(15),
    "cli_codigo_postal" varchar(10),
    "cli_pais" varchar(15),
    "cli_telefono" varchar(24),
    "cli_mail" varchar(24)
);

CREATE TABLE "miapp_empleado" (
    "id_empleado" integer NOT NULL PRIMARY KEY AUTOINCREMENT,
    "emp_nombre" varchar(20) NOT NULL,
    "emp_apellido" varchar(10) NOT NULL,
    "emp_titulo" varchar(30),
    "emp_mail" varchar(25),
    "emp_fechanac" date,
    "emp_fecha_contrato" date,
    "emp_direccion" varchar(80),
    "emp_celular" varchar(24),
    "emp_foto" blob,
    "emp_notas" text
);

CREATE TABLE "miapp_categoria" (
    "id_categoria" integer NOT NULL PRIMARY KEY AUTOINCREMENT,
    "cat_nombre" varchar(15) NOT NULL,
    "cat_desc" text NOT NULL,
    "cat_foto" blob NOT NULL
);

CREATE TABLE "miapp_producto" (
    "id_producto" integer NOT NULL PRIMARY KEY AUTOINCREMENT,
    "pro_nombre" varchar(40) NOT NULL,
    "pro_descripcion" varchar(30) NOT NULL,
    "pro_precio" numeric(19, 4) NOT NULL,
    "pro_stock" integer NOT NULL,
    "id_categoria_id" integer NOT NULL REFERENCES "miapp_categoria" ("id_categoria") DEFERRABLE INITIALLY DEFERRED
);

CREATE TABLE "miapp_proveedor" (
    "id_proveedor" integer NOT NULL PRIMARY KEY AUTOINCREMENT,
    "prv_empresa" varchar(40) NOT NULL,
    "prv_giro" varchar(20) NOT NULL,
    "prv_contacto" varchar(30) NOT NULL,
    "prv_direccion" varchar(60) NOT NULL,
    "prv_pco_postal" varchar(10) NOT NULL,
    "prv_telefono" varchar(24) NOT NULL
);

CREATE TABLE "miapp_orden" (
    "id_orden" integer NOT NULL PRIMARY KEY AUTOINCREMENT,
    "ord_fecha" date,
    "id_cliente_id" varchar(5) NOT NULL REFERENCES "miapp_cliente" ("id_cliente") DEFERRABLE INITIALLY DEFERRED,
    "id_empleado_id" integer REFERENCES "miapp_empleado" ("id_empleado") DEFERRABLE INITIALLY DEFERRED
);

CREATE TABLE "miapp_detalleorden" (
    "id_detalle" integer NOT NULL PRIMARY KEY AUTOINCREMENT,
    "cantidad" integer NOT NULL,
    "precio_unitario" numeric(10, 2) NOT NULL,
    "descuento" numeric(5, 2) NOT NULL,
    "orden_id" integer NOT NULL REFERENCES "miapp_orden" ("id_orden") DEFERRABLE INITIALLY DEFERRED,
    "producto_id" integer NOT NULL REFERENCES "miapp_producto" ("id_producto") DEFERRABLE INITIALLY DEFERRED
);
